<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>shell书写规范建议 - 梅炜 个人博客</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="willmei" />
  <meta name="description" content="Shell书写规范 很多时候在 shell 脚本的编写过程中大家对于语法和编码都是比较随意的, 对于临时性的脚本并不太需要很关注风格规范, 但是如果长期维护的" />

  <meta name="keywords" content="Hugo, theme, jane" />






<meta name="generator" content="Hugo 0.64.1" />


<link rel="canonical" href="https://www.iterdaily.com/post/shell-script-flavor/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">




<link rel="stylesheet" href="/css/custom_code.css">


<meta property="og:title" content="shell书写规范建议" />
<meta property="og:description" content="Shell书写规范 很多时候在 shell 脚本的编写过程中大家对于语法和编码都是比较随意的, 对于临时性的脚本并不太需要很关注风格规范, 但是如果长期维护的" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.iterdaily.com/post/shell-script-flavor/" />
<meta property="article:published_time" content="2020-07-28T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-07-28T00:00:00+00:00" />
<meta itemprop="name" content="shell书写规范建议">
<meta itemprop="description" content="Shell书写规范 很多时候在 shell 脚本的编写过程中大家对于语法和编码都是比较随意的, 对于临时性的脚本并不太需要很关注风格规范, 但是如果长期维护的">
<meta itemprop="datePublished" content="2020-07-28T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-07-28T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="6122">



<meta itemprop="keywords" content="shell," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="shell书写规范建议"/>
<meta name="twitter:description" content="Shell书写规范 很多时候在 shell 脚本的编写过程中大家对于语法和编码都是比较随意的, 对于临时性的脚本并不太需要很关注风格规范, 但是如果长期维护的"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">ITer Daily</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/post/">全部文章/存档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/tags/">关键词/标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/categories/"> 领域/分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/about/">作者</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          <div class="mobile-menu-parent">
            <span class="mobile-submenu-open"></span>
            <a href="https://www.iterdaily.com/about/">
              友站
            </a>
          </div>
          <ul class="mobile-submenu-list">
            
              <li>
                <a href="https://docs.iterdaily.com">在线文档</a>
              </li>
            
              <li>
                <a href="https://kanban.iterdaily.com">Wekan 看板</a>
              </li>
            
              <li>
                <a href="https://git.iterdaily.com">GitLab 仓库</a>
              </li>
            
              <li>
                <a href="https://jenkins.iterdaily.com">Jenkins 服务器</a>
              </li>
            
          </ul>
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      ITer Daily
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/post/">全部文章/存档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/tags/">关键词/标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/categories/"> 领域/分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/about/">作者</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          <a class="menu-item-link menu-parent" href="https://www.iterdaily.com/about/">友站</a>
          <ul class="submenu">
            
              <li>
                <a href="https://docs.iterdaily.com">在线文档</a>
              </li>
            
              <li>
                <a href="https://kanban.iterdaily.com">Wekan 看板</a>
              </li>
            
              <li>
                <a href="https://git.iterdaily.com">GitLab 仓库</a>
              </li>
            
              <li>
                <a href="https://jenkins.iterdaily.com">Jenkins 服务器</a>
              </li>
            
          </ul>

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">shell书写规范建议</h1>
      
      <div class="post-meta">
        <time datetime="2020-07-28" class="post-time">
          2020-07-28
        </time>
        <div class="post-category">
            <a href="https://www.iterdaily.com/categories/linux/"> linux </a>
            
          </div>
        

        
        
          <span id="busuanzi_container_page_pv">
            | 阅读 <span id="busuanzi_value_page_pv"></span>
          </span>
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#脚本文件命名">脚本文件命名</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#脚本解释器-shebang-信息">脚本解释器 shebang 信息</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#脚本注释">脚本注释</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#变量命名规则">变量命名规则</a></li>
    <li><a href="#参数处理">参数处理</a></li>
    <li><a href="#字符编码">字符编码</a></li>
    <li><a href="#日志与控制台回显">日志与控制台回显</a></li>
    <li><a href="#代码范式">代码范式</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <h1 id="shell书写规范">Shell书写规范</h1>
<p>很多时候在 shell 脚本的编写过程中大家对于语法和编码都是比较随意的, 对于临时性的脚本并不太需要很关注风格规范, 但是如果长期维护的脚本, 没有统一规范会带来很多后期维护上的不便, 这里可以给出一些编写建议以供参考.</p>
<h2 id="脚本文件命名">脚本文件命名</h2>
<h4 id="要求">要求:</h4>
<p>对于 Linux shell 脚本的命名统一使用 <code>.sh</code> 后缀结尾.  (windows 环境下批处理程序统一使用 <code>.bat</code> 作为脚本后缀名.)</p>
<p>请使用易于识别的文件名与后缀名, 以方便识别和执行权限检查, 优先使用脚本用途为脚本命名, 请避免使用无意义的字母与没有关联性的单词对脚本文件名命.</p>
<h2 id="脚本解释器-shebang-信息">脚本解释器 shebang 信息</h2>
<p>bash 脚本通常都可以采用 <code>bash script-path/script-name.sh</code> 的方式手动运行. 不同的发行版中 shell 默认的解释器有时是会变化的, 正确的解释器是脚本正常执行的基本, 因此给出明确的解释器信息是十分必要的, 这也是一份规范的可执行脚本必须满足的基本要求.</p>
<h4 id="说明">说明:</h4>
<p><code>#!</code> 是 <code>sharp</code> 加 <code>bang</code> , 也就是 <code>shebang</code> .
Shebang 这个符号通常在 Unix 系统的脚本中第一行开头中写到,它指明了执行这个脚本文件的解释程序.</p>
<ol>
<li>如果脚本文件中没有 <code>#!</code>  这一行,那么在执行时会默认使用当前shell去解释这个脚本（即$shell环境变量）.</li>
<li>如果 <code>#!</code> 之后的解释程序是一个可执行文件,那么执行这个脚本时, shell 就会把文件名及其参数作为参数传给标示的解释程序去执行.</li>
<li>如果 <code>#!</code>指定的解释程序没有可执行权限,则会报错 &lsquo;bad interpreter：Permission denied&rsquo; (拒绝访问,也就是没有权限).</li>
<li>如果 <code>#!</code> 指定的解释程序不是一个可执行文件,那么指定的解释程序会被忽略,转而给当前的shell去执行这个脚本.</li>
<li>如果 <code>#!</code> 指定的解释程序不存在,那么会报错 &lsquo;bad interpret ： No such file ordirectory&rsquo;, 注意: <code>#!</code> 之后的解释程序,需要写其绝对路径（例如：/bin/bash）,他是不会自动到 <code>$PATH</code> 中寻找解释器的.</li>
<li>如果明确指定使用的 &lsquo;bash script_name.sh&rsquo; 这样的命令来执行脚本, 那么 <code>#!</code> 这一行将被忽略,解释器将使用命令行中显示式指定的 bash解释器.</li>
</ol>
<h4 id="要求-1">要求:</h4>
<p>对于需要多次重复使用的脚本中须尽量在脚本的第一行指定解释器信息.</p>
<p>查看本地支持的解释器可以使用 <code>cat /etc/shells</code></p>
<p>示例:</p>
<pre><code>#!/bin/sh
#!/bin/bash
#!/usr/bin/awk
#!/bin/sed
#!/usr/bin/tcl
#!/usr/bin/expect
#!/usr/bin/perl
#!/usr/bin/env python
</code></pre><p>对于 <code>bash</code>  与  <code>sh</code> 的使用上推荐使用 bash. 使用 bash 执行可以保证 shell 中的扩展语法正常工作, 如增量赋值, 特殊变量展开语法等在部分系统的 sh 解释器中是不支持的, 这将导致脚本不可预知的执行异常.</p>
<p>部分系统的 sh 为 bash 的软链接, 对于已经验证正常的脚本也允许使用 sh 解释器.</p>
<p>脚本中不推荐下面的写法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#!/usr/share/env bash
</span></code></pre></div><p>建议使用 <code>/bin/</code> 下的启动文件而非程序的安装路径, 不同版本 Linux 系统, 默认的 env 命令可能安装在不同的系统路径中, 此处的写法具有较弱的通用性.</p>
<h2 id="脚本注释">脚本注释</h2>
<h4 id="头部注释">头部注释</h4>
<p>脚本的头部注释通常需要将脚本的后续维护追溯信息进行备注, 建议包含以下信息</p>
<ol>
<li>作者(与联系方式)</li>
<li>写作与修改日期</li>
<li>脚本的用途</li>
<li>脚本注意事项</li>
<li>脚本版本</li>
<li>开发/执行平台版本</li>
<li>关联开源软件协议/版权</li>
</ol>
<p>示例</p>
<pre><code>###########################################################
# Author  : william mei
# Date    : 20181010
# version : cfiojobs0.12.53
# Test platform:
#               kernel     : 3.10.0-514.26.2.el7.x86_64
#               OS release : CentOS 7.3.1611
#               Shell type : GNU Bash-4.2
# description  :
#               send files/command to multy host 
#               parallel fio test on clusters 
# last edit :   20181225
###########################################################
</code></pre><p>提示：开发环境下可通过配置 <code>~/.vimrc</code> 配置文件将脚本自动加上以上信息.</p>
<h4 id="注释通用要求">注释通用要求</h4>
<ol>
<li>对于关键执行逻辑请务必说明上下文关联.</li>
<li>独立函数需要注明是否有全局变量依赖, 参数格式, 输出结果, 返回值.</li>
<li>非交互式环境中外部环境变量依赖须在脚本头部注释后给出依赖的变量内容与格式说明.</li>
<li>脚本中的参数传递与接收处理部分务必标注 位置 内容与类型, 并带有参数使用示例.</li>
<li>对变量命名用词不能完全保证其清晰准确并可读的情况, 复杂变量拼接应尽量使用结果示例作为注释进行标注</li>
<li>尽量使用英文注释, 防止切换系统环境后出现中文乱码问题.</li>
<li>尽量将注释信息独占一行, 保持与前后代码的同级缩进</li>
</ol>
<h2 id="变量命名规则">变量命名规则</h2>
<ol>
<li>变量名必须是以字母或下划线 &lsquo;_&rsquo; 开头, 后面跟字母 数字或下划线.</li>
<li>变量名中间不能有空格, 可以使用下划线连接.</li>
<li>普通变量一般统一使用小写字母加下划线, 请避免驼峰命名法与下划线混用.</li>
<li>变量名不要使用问号 &lsquo;?&rsquo; 星号 &lsquo;*&rsquo; 或其他特殊字符.</li>
<li>变量名不能使用标点符号, 更不能使用 bash 里的关键字, 例如：if, for, while, do等关键字.</li>
<li>变量名的命名尽量要有实际意义, 具有明确的内容指示性, 复用性较高的变量避免使用单字母命名.</li>
<li>变量名中的单词尽量保证拼写正确, 必要的情况下请进行检查后再使用, 不要拼错</li>
<li>自定义变量尽量不要和系统环境变量冲突.</li>
<li>函数内局部变量最好使用 local 进行定义, 以避免命名污染.</li>
<li>联合数组与指数数组都尽量使用大写单词或词组命名.</li>
<li>外部引入的环境变量或关键全局变量须定义在脚本开头, 以大写字母命名并配置变量检查和使用注释.</li>
</ol>
<h2 id="参数处理">参数处理</h2>
<p>脚本或脚本中的函数进行参数接收时应遵循以下规范</p>
<ol>
<li>格式检查, 当脚本或函数需要接收参数时, 应尽量对参数进行格式规范判断(参数个数, 内容正则匹配检查等), 允许的情况下给出日志输出或者控制台回显.</li>
<li>位置参数重新赋值, 当脚本或函数对参数较多与处理步骤较多或者调用位置代码跨度较大的情况, 应尽量将接收到的参数赋值为具有实际可读性的变量名, 避免沿用原有数字序号.</li>
<li>函数中的参数如需赋值到临时变量须优先使用局部变量(如 local declare等), 若使用全局变量请给出注释以说明</li>
<li>脚本模块化拆分时, 拆分到独立文件公共函数应尽量以纯函数的方式编写, 尽量全部采用局部变量进行处理参数</li>
</ol>
<h2 id="字符编码">字符编码</h2>
<p>脚本编写时尽量使用 UTF-8 编码, 脚本的代码与标点符号必须为英文, 注释内容允许使用少量中文但整体应尽量保持以英文为主, 日志与控制台输出须尽量采用英文输出, 以避免不必要的编码问题.</p>
<p>跨平台编写脚本时, 若未开启 git 等代码版本管理软件的自动换行符转换(默认开启), 应避免直接使用 windows 系统换行符.</p>
<h2 id="日志与控制台回显">日志与控制台回显</h2>
<p>在非临时性脚本的编写中, 须保证脚本的日志输出或控制台回显二者当中至少有一种包含了执行的关键纠错信息, 也可以两者都输出, 如 <code>main |tee -a $logfile</code> .</p>
<p>对于日志和关键输出, 请尽量带有可识别的日志级别标示, 非关键内容则允许过滤处理或者重定向到其他临时输出.</p>
<p>日志级别参考:</p>
<ol>
<li>DEBUG  指出细粒度信息事件对调试应用程序是非常有帮助的, 主要用于开发过程中打印一些运行信息.</li>
<li>INFO  消息在粗粒度级别上突出强调应用程序的运行过程. 打印一些你感兴趣的或者重要的信息, 这个可以用于生产环境中输出程序运行的一些重要信息, 但是不能滥用, 避免打印过多的日志.</li>
<li>WARN  表明会出现潜在错误的情形, 有些信息不是错误信息, 但是也要给程序员的一些提示.</li>
<li>ERROR  指出虽然发生错误事件, 但仍然不影响系统的继续运行. 打印错误和异常信息, 如果不想输出太多的日志, 可以使用这个级别.</li>
<li>FATAL  指出每个严重的错误事件将会导致应用程序的退出. 这个级别比较高了. 重大错误, 这种级别你可以直接停止程序了.</li>
</ol>
<p>为了更加清晰的指示执行状态或结果, 脚本允许增加其他自定义日志级别与其他自定义内容输出标示, 但应与非关键输出做出显示上的区分处理, 如颜色, 闪烁等.</p>
<h2 id="代码范式">代码范式</h2>
<p>针对脚本中的代码范式规范如下:</p>
<h4 id="代码换行">代码换行</h4>
<p>单行代码建议在80个字符以内, 当单行代码过长的情况下, 如在调用程序或函数需要处理较长的参数时, 为了控制单行代码长度, 可以使用反斜杠进行分行处理, 如:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">./configure <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>–prefix<span style="color:#f92672">=</span>/usr <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>–sbin-path<span style="color:#f92672">=</span>/usr/sbin/nginx <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>–conf-path<span style="color:#f92672">=</span>/etc/nginx/nginx.conf <span style="color:#ae81ff">\
</span></code></pre></div><p>注意, 反斜杠前须保留一位空格.</p>
<p>当函数的行数超过100行, 请考虑对函数进行拆分.</p>
<h4 id="代码缩进">代码缩进</h4>
<p>对于脚本代码缩进, 我们允许使用以下 3 种缩进单位</p>
<ol>
<li>双空格 缩进</li>
<li>四空格 缩进    (推荐)</li>
<li>tab 制表符 缩进</li>
</ol>
<p>推荐使用 <code>四个空格</code> 作为标准缩进单位, 同一份脚本中不允许混用多种缩进单位, 同项目中的脚本不允许混用多种缩进单位.</p>
<p>制表符仅针对于遗留脚本进行修改的情形, 若其原有缩进使用制表符则遵循其原有的缩进规则, 新编写的脚本请避免使用制表符.</p>
<p>绝大多数编辑器都支持进行代码的 <code>soft tab</code> 配置, 也就是使用 n 个(通常为2或4个) 空格替代 制表符进行缩进.</p>
<h4 id="变量引用">变量引用</h4>
<p>脚本中的变量引用允许使用一下几种形式:</p>
<ol>
<li><code>$parameter</code> 方式</li>
<li><code>${parameter}</code> 方式</li>
<li><code>&quot;$parameter&quot;</code> 方式    (推荐)</li>
<li><code>&quot;${parameter}&quot;</code> 方式     (推荐)</li>
<li><code>$&quot;parameter&quot;</code> 方式    (特殊情况允许, 不推荐)</li>
</ol>
<p>推荐对所有引用的变量添加引号, 以避免赋值动作以外的其他解释错误和不可预知的执行后果, 比如变量中包含分隔符和正则匹配字符的情形.</p>
<p>一般情况下允许前 4 中方式混用, 在非特殊用途的变量展开表达式以外应尽量避免 <code>$&quot;parameter&quot;</code> 的引用写法, 它在不同的发行版中(由解释器关联的系统 POSIX 接口所决定)可能会有不同的展开结果.</p>
<p>推荐在进行变量拼接的过程中使用 <code>${parameter}</code> 与 <code>&quot;${parameter}&quot;</code> .</p>
<h4 id="数据传递与变量作用域控制">数据传递与变量作用域控制</h4>
<h5 id="说明-1">说明:</h5>
<p>shell 的变量默认是以全局变量的方式被定义的, 但支持以局部变量的方式在函数中限制变量的作用域.</p>
<p>shell 脚本通常是过程式的, 无法以对象的方式抽象数据和方法, 代码的复用通常是以编写函数的方式进行的, 而函数的数据传递方式对代码的整体可读性和健壮性有较大影响, 在 shell 中常见的数据传递方式有:</p>
<ol>
<li>全局变量方式传递</li>
<li>环境变量方式传递    (不推荐)</li>
<li>参数方式传递</li>
<li>管道方式传递</li>
<li>文件描述符</li>
<li>信号捕获</li>
</ol>
<h5 id="要求-2">要求:</h5>
<p>这里, 对于以上几种方式在都允许使用, 但多种方式都能达到同样效果的情况下, 我们建议采用如下选取原则.</p>
<p>调用子脚本时, 允许使用环境变量向子 shell 传递数据, 但更推荐为子脚本添加参数接收支持的处理方式.</p>
<p>首先, 不推荐采用环境变量方式向函数子进程传递数据, 因为这让整个数据传递的过程变得不够清晰, 可读性也相对较差, 若命名也不够清晰规范将大幅度增加排障难度.</p>
<p>其次, 函数中若使用局部变量没有增加较大编码负担的情况下, 应避免使用全局变量, 减少与外部的关联可以很大程度上提高函数代码的稳定性, 推荐使用纯函数进行相关复用代码的编写, 这可以在一定程度上提高代码的健壮性和可读性.</p>
<p>函数中的变量处理优先使用局部变量, 采用如, local declare 等方式进行声明.</p>
<ul>
<li>环境变量</li>
</ul>
<p>在脚本中多处使用的环境变量应在头部注释后进行声明(大写字母加下划线命名, 并注释其内容类型加示例).</p>
<p>除了调用程序的特殊流程处理需要(如配置部分编译器的编译环境), 应尽量避免制造过多临时性的环境变量.</p>
<p>如果脚本中没有调用对环境变量有特殊要求的应用程序应尽量避免使用环境变量传递数据.</p>
<ul>
<li>只读变量</li>
</ul>
<p>特殊变量如版本号字符串等可以采用 readonly 方式限制为只读, 以避免被修改.</p>
<h4 id="变量展开与字符处理程序调用">变量展开与字符处理程序调用</h4>
<p>在 shell 中针对变量的字符串截取等操作可以有多种实现方式, 最典型的两种是</p>
<ol>
<li>内置变量展开表达式, 如 <code>${parameter:offset:length}</code> <code>${parameter/pattern/string}</code> 等</li>
<li>调用外部字符处理工具, 如, <code>grep</code> <code>sed</code> <code>awk</code> <code>cut</code> 等</li>
</ol>
<p>对于相对简单的当字符串的处理, 若两种方式均可实现的情况下, 优先采用内置变量展开, 如</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span><span style="color:#75715e"># example of Parameter Expansion</span>

<span style="color:#75715e"># 1. 变量字符替换</span>
para1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;hello_john&#34;</span>

<span style="color:#75715e"># Parameter Expansion</span>
result1<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>para1//john/jack<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#75715e"># use sed</span>
result2<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>echo $para1|sed <span style="color:#e6db74">&#39;s/john/jack/g&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>

<span style="color:#75715e"># 2. 剔除路径,获取文件名</span>
full_path<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;file/path/file_name&#34;</span>

<span style="color:#75715e"># Parameter Expansion</span>
result3<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>full_path##*/<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#75715e"># use awk</span>
result4<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>echo $full_path| awk <span style="color:#e6db74">&#39;{print$NF}&#39;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</code></pre></div><p>对于字符处理频度较低的脚本, 两种方式均可.</p>
<p>但在需要频繁字符处理的情况下, 请优先使用内置变量展开方式进行处理, 内置的展开表达执行非常快速, 其耗时几乎可以忽略不计, 并且还可以避免字符处理程序调用带来的大量外部进程, 显著提高脚本的运行速度.</p>
<h4 id="命令输出置换">命令输出置换</h4>
<p>在 shell 脚本中, 命令置换语法通常有两种形式:</p>
<ol>
<li>` command`  双反引号     (尽量避免)</li>
<li><code>$(command)</code> 美元符加圆括号    (推荐)</li>
</ol>
<p>这里如果没有特殊需求, 请尽量使用美元符加圆括号的写法.</p>
<p>旧式的双反引号语法有转译符号的特殊处理, 尤其是反斜杠自身的转译, 因此对于引用和字符转译处理并不友好, 如果脚本中的命令存在多层转译会导致可读性变差, 并且将增加 debug 以及维护难度.</p>
<h4 id="流程控制语句">流程控制语句</h4>
<p>下面两种写法的流程控制语句都是允许的:</p>
<p>如, 将条件判断语句与后面的关键词写在一行的情形</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span><span style="color:#f92672">[</span> condition <span style="color:#f92672">]</span><span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
    <span style="color:#75715e">#statements</span>
<span style="color:#66d9ef">fi</span>
</code></pre></div><p>或, 将条件判断语句独立一行, 下一个关键词另起一行的写法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span><span style="color:#f92672">[</span> condition <span style="color:#f92672">]</span><span style="color:#f92672">]</span>;
<span style="color:#66d9ef">then</span>
    <span style="color:#75715e">#statements</span>
<span style="color:#66d9ef">fi</span>
</code></pre></div><p>两种都是允许的, 但是同一种风格的语句尽量不要来回变换, 在同一份脚本中, 请务必保持使用一种风格的写法.</p>
<p>建议, 若脚本中的条件判断语句长度大多都不超过一行的情况下, 尽量使用第一种写法.</p>
<p>示例:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># for 关键词遍历</span>
<span style="color:#66d9ef">for</span> name in word ... ; <span style="color:#66d9ef">do</span>
    list
<span style="color:#66d9ef">done</span>
<span style="color:#75715e"># C 式for循环</span>
<span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#f92672">(</span> i <span style="color:#f92672">=</span> 0; i &lt; 10; i++ <span style="color:#f92672">)</span><span style="color:#f92672">)</span>; <span style="color:#66d9ef">do</span>
    <span style="color:#75715e">#statements</span>
<span style="color:#66d9ef">done</span>
<span style="color:#75715e"># case 关键词遍历</span>
<span style="color:#66d9ef">case</span> word in
    pattern <span style="color:#f92672">)</span>
        ;;
<span style="color:#66d9ef">esac</span>
<span style="color:#75715e"># select 关键词遍历</span>
<span style="color:#66d9ef">select</span> name <span style="color:#f92672">[</span> in word <span style="color:#f92672">]</span> ; <span style="color:#66d9ef">do</span>
    list
<span style="color:#66d9ef">done</span>
<span style="color:#75715e"># while 条件循环</span>
<span style="color:#66d9ef">while</span> <span style="color:#f92672">[</span><span style="color:#f92672">[</span> condition <span style="color:#f92672">]</span><span style="color:#f92672">]</span>; <span style="color:#66d9ef">do</span>
    <span style="color:#75715e">#statements</span>
<span style="color:#66d9ef">done</span>
<span style="color:#75715e"># until 循环</span>
<span style="color:#66d9ef">until</span> <span style="color:#f92672">[</span><span style="color:#f92672">[</span> condition <span style="color:#f92672">]</span><span style="color:#f92672">]</span>; <span style="color:#66d9ef">do</span>
    <span style="color:#75715e">#statements</span>
<span style="color:#66d9ef">done</span>
</code></pre></div><h4 id="文件路径">文件路径</h4>
<p>在脚本的文件路径处理中, 须遵循绝对路径优先原则.</p>
<p>除了 git  等需要相对路径工作的程序外, 脚本中的位置处理应尽量使用绝对路径.</p>
<p>示例:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">script_dir<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>cd <span style="color:#66d9ef">$(</span>dirname $0<span style="color:#66d9ef">)</span> <span style="color:#f92672">&amp;&amp;</span> pwd<span style="color:#66d9ef">)</span>
script_dir<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>dirname <span style="color:#66d9ef">$(</span>readlink -f $0 <span style="color:#66d9ef">)</span><span style="color:#66d9ef">)</span>
</code></pre></div><p>脚本优先使用脚本执行路径作为路径依据, 即 <code>$0</code> 所在的位置.</p>
<p>避免直接使用当前 shell 的执行路径, 即 <code>pwd</code> 获取的路径.</p>
<h4 id="条件判别表达式">条件判别表达式</h4>
<p>条件判别表达式通常有以下 3 种常见写法:</p>
<ol>
<li><code>[[ condition ]]</code> 双中括号    (推荐)</li>
<li><code>[ condition ]</code>  单中括号</li>
<li><code>test condition</code> 使用 test 判别表达式</li>
</ol>
<p>以上 3 种写法中, 进行变量值的判别时, 我们应优先使用 <code>[[ condition ]]</code> 的写法, 因为双中括号可以有效避免条件表达式的过度展开, 这可以避免空变量导致的脚本异常.</p>
<p>示例:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># 字符串为空</span>
s<span style="color:#f92672">=</span>
<span style="color:#f92672">[</span> $s <span style="color:#f92672">=</span><span style="color:#f92672">=</span> a <span style="color:#f92672">]</span> <span style="color:#f92672">||</span> echo <span style="color:#e6db74">&#34;not match&#34;</span>
<span style="color:#75715e"># 结果异常</span>
bash: <span style="color:#f92672">[</span>: <span style="color:#f92672">=</span><span style="color:#f92672">=</span>: unary operator expected
</code></pre></div><p>双中括号</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># 字符串为空</span>
s<span style="color:#f92672">=</span>
<span style="color:#f92672">[</span><span style="color:#f92672">[</span> $b <span style="color:#f92672">=</span><span style="color:#f92672">=</span> a <span style="color:#f92672">]</span><span style="color:#f92672">]</span> <span style="color:#f92672">||</span> echo <span style="color:#e6db74">&#34;not match&#34;</span>
<span style="color:#75715e"># 结果正常</span>
not match
</code></pre></div><p>在含命令置换的条件判别表达式中, 如 <code>[[ $(func_name args) == 'str' ]]</code> , 此时, 双中括号将不会调用嵌套的多层函数, 如果表达式有多层函数嵌套(虽然也不建议这种写法), 需要使用单中括号才能将嵌套函数正常执行.</p>
<p>注意, 部分 shell 并不支持 双中括号 语法, 因此请务必确保 <code>shebang</code> 信息正确, 并使用正确的解释器执行(参考开头的说明).</p>
<h4 id="命令逻辑运算符">命令逻辑运算符</h4>
<p>shell 脚本中在单行命令长度较短, 判别逻辑简单的情况下 (不含使用 <code>elif</code> 的情形), 使用命令的逻辑运算符可以简化判别逻辑, 使代码更加简洁, 推荐使用逻辑运算符代替 <code>if ... else ...</code> 的写法.</p>
<p>示例:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># 简单 if 判断</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span><span style="color:#f92672">[</span> condition <span style="color:#f92672">]</span><span style="color:#f92672">]</span>;<span style="color:#66d9ef">then</span>
    command1
<span style="color:#66d9ef">else</span>
    command2
<span style="color:#66d9ef">fi</span>
<span style="color:#75715e"># 等价于</span>
<span style="color:#f92672">[</span><span style="color:#f92672">[</span> condition <span style="color:#f92672">]</span><span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> command1 <span style="color:#f92672">||</span> command2

<span style="color:#75715e"># 连续 And</span>
cmd1 <span style="color:#f92672">&amp;&amp;</span> cmd2 <span style="color:#f92672">&amp;&amp;</span> cmd3

<span style="color:#75715e"># 连续 Or</span>
cmd1 <span style="color:#f92672">||</span> cmd2 <span style="color:#f92672">||</span> cmd3
</code></pre></div><p>命令逻辑运算符不能过度使用, 以下情形建议继续使用  <code>if ... else...</code> 或其他流程控制写法.</p>
<ol>
<li>采用逻辑运算符后无法在一行内完成代码书写的情况</li>
<li>单行代码包含不止一种逻辑运算符, 且数量超过3个的情况</li>
</ol>
<h4 id="函数定义">函数定义</h4>
<p>示例:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># 优先使用显示定义</span>
<span style="color:#66d9ef">function</span> func_name<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">{</span>
    local ret_value
    command
    <span style="color:#66d9ef">return</span> $ret_value
<span style="color:#f92672">}</span>
<span style="color:#75715e"># 允许</span>
func_name<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">{</span>
    local ret_value
    command
    <span style="color:#66d9ef">return</span> $ret_value
<span style="color:#f92672">}</span>
<span style="color:#75715e"># 允许</span>
<span style="color:#66d9ef">function</span> func_name <span style="color:#f92672">{</span>
    local ret_value
    command
    <span style="color:#66d9ef">return</span> $ret_value
<span style="color:#f92672">}</span>
</code></pre></div><h4 id="屏幕回显处理">屏幕回显处理</h4>
<p>在主动生成新的回显信息的时候通常有两种内置命令可供选择 <code>echo</code> 与 <code>printf</code></p>
<p>示例:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># 显示带有红色加粗标识的错误提示</span>
echo -e <span style="color:#e6db74">&#34;\e[1;31m[ERROR] file not found \e[0m&#34;</span>

<span style="color:#75715e"># 格式化输出</span>
printf <span style="color:#e6db74">&#34;%-10s %-8s %-24s\n&#34;</span> id name url  
</code></pre></div><p>这两种方式中, 在简单的回显可以使用 <code>echo</code> 进行处理, 但是格式化输出内容应优先使用 <code>printf</code> , 其功能也更加丰富, 并且绝大多数 shell 的<code>printf</code> 都与 C 程序库中 <code>printf()</code> 相一致, 遵照统一的 <code>POSIX</code> 规范, 脚本可以有较好的移植性.</p>
<p>注意, 一般情况下如果可以通过 <code>prinf</code> 格式化输出的内容, 应尽量避免手动使用空格进行回显的格式化.</p>
<p>其他写法建议:</p>
<ol>
<li>处理并发任务时避免使用管道向循环结构体传值.</li>
<li>使用 <code>fd</code> 控制并发处理时, 子进程异常处理需要保证读取的值被放回队列.</li>
<li>当需要大量 <code>sed</code> 与 <code>grep</code> 组合才能完成字符处理的场景, 请考虑完全使用 <code>awk</code> 完成任务.</li>
<li>避免通过对 <code>ls</code> 的输出处理来获取数据, <code>ls</code> 的结果会带来不确定行, 并且与平台相关.</li>
<li>尽量为编写的函数配置返回值, 以判断执行状况.</li>
<li>外部调用与内置命令均能完成任务时, 内部命令优先.</li>
<li>完成同样的内容请尽量减少使用的命令数, 如 <code>cat</code> 加 管道的处理方式.</li>
<li>如果有需要 source 子脚本才能正常执行的情况, 请考虑将它们写成函数.</li>
<li>使用 <code>mktemp</code> 生成临时文件或者临时文件夹, 并在结束后清理.</li>
<li>使用 <code>/dev/null</code> 过滤无用或其他不友好的输出信息.</li>
<li>脚本中需要使用文件之前, 应先判断文件是否存在，否则应做好异常处理.</li>
<li>会使用trap捕获信号，并在接受到终止信号时执行一些收尾工作</li>
</ol>
<p>书写建议:</p>
<ol>
<li>成对内容的一次写出来,防止漏写.例如：{},[],'',``,&quot;&quot;.</li>
<li>[]中括号两端都要有空格,书写时可留出空格,然后退格书写内容.</li>
<li>流程控制语句 (如, if [[ condition]] ;then command ; fi ) 一次书写完,在添加内容.</li>
<li>使用专门的编辑器进行脚本编写(避免留下 windows 文本 BOM 头编码).</li>
<li>使用静态编码检查工具.</li>
</ol>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">willmei</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2020-07-28
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://www.iterdaily.com/tags/shell/">shell</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/web_django_upgrade_sqlite3/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">如何正确升级 sqlite3 (CentOS)</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/rhel-ceph-ansible-deployment/">
            <span class="next-text nav-default">Redhat ceph-ansible 快速部署流程</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:williammei@126.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/will-mei" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>
  
    <a href="https://git.iterdaily.com" rel="me noopener" class="iconfont"
      title="gitlab"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M59.544137 403.419429L512.115566 983.405714 16.09728 623.396571a39.936 39.936 0 0 1-14.299429-43.995428l57.709715-176.018286z m264.009143 0h377.161143L512.152137 983.405714zM210.40128 53.723429l113.152 349.696H59.544137l113.152-349.696a20.041143 20.041143 0 0 1 37.705143 0z m754.285714 349.696l57.709715 176.018285a39.862857 39.862857 0 0 1-14.299429 43.995429l-496.018286 360.009143 452.571429-579.986286z m0 0h-264.009143l113.152-349.696a20.041143 20.041143 0 0 1 37.705143 0z"></path>
</svg>

    </a>
  
    <a href="https://space.bilibili.com/7388823" rel="me noopener" class="iconfont"
      title="bilibili"  target="_blank"
      >
      <svg
  class="icon" style="" viewBox="0 0 1024 1024" version="1.1" width="36"
  height="36" id="svg8">
  <path
      style=""
      d="M 744.60599,0.00486267 A 41.779915,41.779915 0 0 0 710.4184,18.673394 L 548.5048,255.32642 h -11.70046 a 41.779915,41.779915 0 0 0 -10.80295,-7.84928 L 235.66,97.084498 a 41.779915,41.779915 0 0 0 -20.07193,-4.960864 41.779915,41.779915 0 0 0 -18.3748,79.145436 L 359.4859,255.32642 H 128.16909 c -49.458302,0 -89.27932,39.82105 -89.27932,89.27932 v 508.65224 c 0,49.4583 39.821018,89.27934 89.27932,89.27934 h 19.48445 C 149.12802,984.5043 179.92773,1024 224.79179,1024 c 44.86407,0 75.66379,-39.4957 77.13826,-81.46268 H 719.98116 C 721.45559,984.5043 752.25533,1024 797.1194,1024 c 44.86406,0 75.6638,-39.4957 77.13824,-81.46268 h 21.57323 c 49.45831,0 89.27936,-39.82104 89.27936,-89.27934 V 344.60574 c 0,-49.45827 -39.82105,-89.27932 -89.27936,-89.27932 H 649.74567 L 779.38103,65.866924 A 41.779915,41.779915 0 0 0 744.60599,0.00486267 Z M 644.49108,418.70871 c 6.29985,0.21538 12.44451,2.01107 17.86888,5.22196 l 171.36218,98.10771 c 18.23417,10.21935 24.63334,33.34627 14.24614,51.48533 -10.38726,18.13909 -33.57344,24.32718 -51.61587,13.77296 L 624.9903,489.18895 c -15.21356,-8.41858 -22.66871,-26.1765 -18.03211,-42.93436 4.63664,-16.75784 20.15573,-28.14465 37.53289,-27.54588 z M 350.2006,432.31846 c 16.89952,0.0317 31.69582,11.33328 36.17844,27.62747 4.48262,16.2942 -2.44981,33.57765 -16.95507,42.24898 l -140.7157,86.91312 c -17.68528,11.18244 -41.09629,5.77692 -52.08912,-12.02686 -10.99282,-17.80373 -5.33855,-41.15658 12.58167,-51.95857 L 329.9002,438.2095 c 6.0643,-3.86439 13.10951,-5.90891 20.3004,-5.89104 z M 501.605,641.53985 c 3.75002,-0.15248 7.48645,0.53903 10.93349,2.0235 0.15842,0.0637 0.31618,0.12888 0.47325,0.19582 0.59328,0.27092 1.17574,0.56489 1.74609,0.88121 0.15868,0.0854 0.31643,0.17233 0.47325,0.2611 0.55694,0.32165 1.10131,0.66458 1.63185,1.02807 0.16455,0.1123 0.32777,0.2265 0.48956,0.34269 0.50382,0.36781 0.99371,0.75428 1.46868,1.15864 0.18724,0.15504 0.37218,0.31282 0.55484,0.47323 0.43271,0.38784 0.8518,0.79061 1.25653,1.20756 0.15449,0.16114 0.30679,0.32437 0.45693,0.48959 0.40798,0.44266 0.79989,0.89988 1.17494,1.37076 0.17799,0.22544 0.35205,0.45395 0.5222,0.68538 0.25932,0.34701 0.50964,0.70071 0.75064,1.06071 0.26712,0.39516 0.52286,0.79784 0.76699,1.20757 0.16907,0.29043 0.33231,0.58424 0.48957,0.88123 0.21836,0.41297 0.42513,0.83199 0.62009,1.25653 0.14836,0.32333 0.28983,0.64976 0.42429,0.97911 0.21319,0.51552 0.40915,1.03801 0.58747,1.5666 0.0677,0.19499 0.13296,0.39085 0.19582,0.58748 0.18652,0.60823 0.34984,1.22334 0.48957,1.84399 0.0397,0.16277 0.0779,0.32601 0.11423,0.48957 0.1436,0.69112 0.25788,1.38801 0.34269,2.08877 0.005,0.0381 0.0111,0.0761 0.0163,0.11424 0.0857,0.78056 0.13474,1.56471 0.14687,2.34988 0.005,0.0543 0.0111,0.10879 0.0163,0.1632 0,0 -0.008,1.12132 0,1.45234 0,0 -0.14697,17.84761 5.89102,34.12231 3.01902,8.13734 7.33278,15.10615 12.61433,19.61501 5.28157,4.50889 11.42894,7.62081 23.64572,7.62081 12.2168,0 18.36416,-3.11192 23.64573,-7.62081 5.28154,-4.50886 9.5953,-11.47767 12.6143,-19.61501 6.03799,-16.2747 5.89103,-34.12231 5.89103,-34.12231 -0.44885,-13.87045 10.45922,-25.46302 24.3311,-25.86506 13.87189,-0.40201 25.42828,10.53953 25.78348,24.41272 0,0 1.11929,25.7226 -9.00791,53.01927 -5.06359,13.64832 -13.1986,28.46036 -27.05631,40.29073 -13.85772,11.83039 -33.5454,19.63135 -56.20142,19.63135 -22.65603,0 -42.34371,-7.80096 -56.20141,-19.63135 -4.1801,-3.56856 -7.78733,-7.42433 -10.99878,-11.42303 -3.21235,4.00037 -6.81703,7.85309 -10.99876,11.42303 -13.85773,11.83039 -33.5454,19.63135 -56.20144,19.63135 -22.65601,0 -42.3437,-7.80096 -56.2014,-19.63135 -13.85775,-11.83037 -21.99272,-26.64241 -27.05632,-40.29073 -10.12725,-27.29667 -9.00789,-53.01928 -9.00789,-53.01927 0.20714,-13.83687 11.58744,-24.88848 25.42444,-24.69013 14.1263,0.19991 25.2971,12.0278 24.69011,26.14247 0,0 -0.14697,17.84761 5.89103,34.12231 3.01902,8.13734 7.31646,15.10615 12.598,19.61501 5.28155,4.50889 11.44526,7.62081 23.66203,7.62081 12.21681,0 18.36418,-3.11192 23.64573,-7.62081 5.28154,-4.50886 9.57899,-11.47767 12.598,-19.61501 5.76352,-15.53489 5.89112,-32.05691 5.89103,-33.56746 0.006,-0.37466 0.0111,-1.05336 0.0163,-1.20759 -0.0117,-0.74583 0.0105,-1.49177 0.0652,-2.23565 0.009,-0.15784 0.0204,-0.31561 0.0327,-0.47324 0.14204,-1.56859 0.43163,-3.12027 0.86487,-4.63449 0.0213,-0.0763 0.0433,-0.15244 0.0652,-0.22848 3.0335,-10.25748 12.24157,-17.46007 22.92769,-17.93417 z"
      id="rect824"/>
</svg>

    </a>


<a href="https://www.iterdaily.com/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
     备案 - <a class="theme-link" href="http://www.beian.miit.gov.cn/">京ICP备19054960号-1</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2019 -
    2021
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        WilliamMei
        
      </span></span>

  
  
    <span id="busuanzi_container">
      访客数/访问量：<span id="busuanzi_value_site_uv"></span>/<span id="busuanzi_value_site_pv"></span>
    </span>
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  




  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>













<script type="text/javascript" src="//cdn.bootcss.com/viz.js/1.3.0/viz.js"> </script>
<script type="text/javascript">
(function(){
    var vizPrefix = "language-viz-";
    Array.prototype.forEach.call(document.querySelectorAll("[class^=" + vizPrefix + "]"), function(x){
        var engine;
        x.getAttribute("class").split(" ").forEach(function(cls){
            if (cls.startsWith(vizPrefix)) {
                engine = cls.substr(vizPrefix.length);
            }
        });
        var image = new DOMParser().parseFromString(Viz(x.innerText, {format:"svg", engine:engine}), "image/svg+xml");
        x.parentNode.insertBefore(image.documentElement, x);
        x.style.display = 'none'
    });
})();
</script>

</body>
</html>
