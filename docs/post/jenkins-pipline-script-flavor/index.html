<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Jenkins 流水线书写规范建议 - 梅炜 个人博客</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="willmei" />
  <meta name="description" content="Jenkins 流水线书写规范 Jenkins 流水线本身编码可以在 Jenkins 框架本身定义的 DSL内进行, 但不管是 声明式 还是 脚本式 流水线仅仅依靠 jenkins 提供的语法只能搭建起一个基本的运" />

  <meta name="keywords" content="Hugo, theme, jane" />






<meta name="generator" content="Hugo 0.64.1" />


<link rel="canonical" href="https://www.iterdaily.com/post/jenkins-pipline-script-flavor/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">




<link rel="stylesheet" href="/css/custom_code.css">


<meta property="og:title" content="Jenkins 流水线书写规范建议" />
<meta property="og:description" content="Jenkins 流水线书写规范 Jenkins 流水线本身编码可以在 Jenkins 框架本身定义的 DSL内进行, 但不管是 声明式 还是 脚本式 流水线仅仅依靠 jenkins 提供的语法只能搭建起一个基本的运" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.iterdaily.com/post/jenkins-pipline-script-flavor/" />
<meta property="article:published_time" content="2020-08-14T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-08-14T00:00:00+00:00" />
<meta itemprop="name" content="Jenkins 流水线书写规范建议">
<meta itemprop="description" content="Jenkins 流水线书写规范 Jenkins 流水线本身编码可以在 Jenkins 框架本身定义的 DSL内进行, 但不管是 声明式 还是 脚本式 流水线仅仅依靠 jenkins 提供的语法只能搭建起一个基本的运">
<meta itemprop="datePublished" content="2020-08-14T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-08-14T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="5584">



<meta itemprop="keywords" content="jenkins," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Jenkins 流水线书写规范建议"/>
<meta name="twitter:description" content="Jenkins 流水线书写规范 Jenkins 流水线本身编码可以在 Jenkins 框架本身定义的 DSL内进行, 但不管是 声明式 还是 脚本式 流水线仅仅依靠 jenkins 提供的语法只能搭建起一个基本的运"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">ITer Daily</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/post/">全部文章/存档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/tags/">关键词/标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/categories/"> 领域/分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/about/">作者</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          <div class="mobile-menu-parent">
            <span class="mobile-submenu-open"></span>
            <a href="https://www.iterdaily.com/about/">
              友站
            </a>
          </div>
          <ul class="mobile-submenu-list">
            
              <li>
                <a href="https://docs.iterdaily.com">在线文档</a>
              </li>
            
              <li>
                <a href="https://kanban.iterdaily.com">Wekan 看板</a>
              </li>
            
              <li>
                <a href="https://git.iterdaily.com">GitLab 仓库</a>
              </li>
            
              <li>
                <a href="https://jenkins.iterdaily.com">Jenkins 服务器</a>
              </li>
            
          </ul>
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="/lib/photoswipe/photoswipe.min.css" />
  <link rel="stylesheet" href="/lib/photoswipe/default-skin/default-skin.min.css" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      ITer Daily
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/post/">全部文章/存档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/tags/">关键词/标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/categories/"> 领域/分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://www.iterdaily.com/about/">作者</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          <a class="menu-item-link menu-parent" href="https://www.iterdaily.com/about/">友站</a>
          <ul class="submenu">
            
              <li>
                <a href="https://docs.iterdaily.com">在线文档</a>
              </li>
            
              <li>
                <a href="https://kanban.iterdaily.com">Wekan 看板</a>
              </li>
            
              <li>
                <a href="https://git.iterdaily.com">GitLab 仓库</a>
              </li>
            
              <li>
                <a href="https://jenkins.iterdaily.com">Jenkins 服务器</a>
              </li>
            
          </ul>

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Jenkins 流水线书写规范建议</h1>
      
      <div class="post-meta">
        <time datetime="2020-08-14" class="post-time">
          2020-08-14
        </time>
        <div class="post-category">
            <a href="https://www.iterdaily.com/categories/devops/"> devops </a>
            
          </div>
        

        
        
          <span id="busuanzi_container_page_pv">
            | 阅读 <span id="busuanzi_value_page_pv"></span>
          </span>
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#命名">命名</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#注释格式">注释格式</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#credentials与密码配置">credentials与密码配置</a></li>
    <li><a href="#执行环境依赖">执行环境依赖</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#输出配置">输出配置</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#groovy代码块">groovy代码块</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <h1 id="jenkins-流水线书写规范">Jenkins 流水线书写规范</h1>
<p>Jenkins 流水线本身编码可以在 Jenkins 框架本身定义的 DSL内进行, 但不管是 <code>声明式</code> 还是 <code>脚本式</code> 流水线仅仅依靠 jenkins 提供的语法只能搭建起一个基本的运行框架, 能力十分有限, 具体的每个流水线步骤大多还是使用脚本进行的, 虽然 Jenkins 也可用 groovy 完成复杂逻辑处理, 但是我们建议原则上仅仅使用 jenkins 进行 <code>流程控制</code> 和 <code>数据传递</code> , 把它当做一个将数据与代码逻辑分离的粘合框架, 避免将流水线代码写的过于冗长繁复, 通过调用 python 以及 shell 等脚本可以解决的, 尽量使用独立的模块或者外部的公共服务来进行, 语法上针对 Jenkins 流水线脚本的书写, 在遵循 groovy 语法的标准的基础上, 我们给出以下建议:</p>
<h2 id="命名">命名</h2>
<h4 id="文件名">文件名</h4>
<ol>
<li>
<p>请避免将无意义或者不带 <code>Jenkinsfile</code> 标识的名称作为流水线文件名.</p>
</li>
<li>
<p>对于独立的 Jenkins 流水线脚本命名, 无特殊情况下应尽量使用 <code>Jenkinsfile</code> 为文件名.</p>
</li>
<li>
<p>如果需要多个流水线并存的情况推荐使用 <code>Jenkinsfile_&lt;流水线名称&gt;</code> 为文件名.</p>
</li>
<li>
<p>文件名中, 名称统一使用小写英文单词加下划线方式命名, 除流水线文件外尽量不要省略后缀.</p>
</li>
<li>
<p>流水线模块请尽量使用 <code>模块用途</code> + <code>模块语言标准后缀</code> 的方式命名, 如</p>
<ol>
<li>groovy 模块扩展: common.groovy</li>
<li>shell 模块扩展: pip_build.sh</li>
<li>python 模块扩展: merge_yml.py</li>
<li>以此类推</li>
</ol>
</li>
</ol>
<h4 id="变量命名">变量命名</h4>
<p>准确简洁的变量名是可读性的重要保障, 针对脚本的变量名应当至少遵循以下规范:</p>
<ol>
<li>
<p>变量名必须有实际含义, 避免英文数字下划线以外的特殊字符.</p>
</li>
<li>
<p>避免变量名过短(数据或对象内容复杂而变量名无法推断其含义)与过长(变量名接近甚至超过半行造成视觉阅读困难).</p>
</li>
<li>
<p>变量名尽量避开 groovy 语言自身关键字, 避开环境变量.</p>
</li>
<li>
<p>统一使用一种命名规则, 如小驼峰命名法.</p>
</li>
<li>
<p>自定义环境变量命名尽量采用大写与下划线单词命名</p>
</li>
<li>
<p>无特殊需求, 请避免修改流水线默认生成的环境变量.</p>
</li>
<li>
<p>在固定的拼接处理中, 应尽量减少定义语句使用的嵌套层数</p>
<p>例如</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#75715e">// 套娃式定义
</span><span style="color:#75715e"></span><span style="color:#66d9ef">def</span> pathA <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;path1&#34;</span>
<span style="color:#66d9ef">def</span> paraZ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${pathA}/path2&#34;</span>
<span style="color:#66d9ef">def</span> paraB <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${pathZ}/path3&#34;</span>
<span style="color:#66d9ef">def</span> paraY <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${pathB}/path4&#34;</span>
<span style="color:#66d9ef">def</span> paraX <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${pathY}/path5&#34;</span>
    
<span style="color:#75715e">// 展开嵌套, 具有更好的可读性
</span><span style="color:#75715e"></span><span style="color:#66d9ef">def</span> paraX <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;path1/path2/path3/path4/path5&#34;</span>
</code></pre></div></li>
</ol>
<h4 id="stage与标签命名">stage与标签命名</h4>
<p>流水线的任务和标签, 遵循使用注释性的语言进行命名, 可以使用中文语句作为名称, 建议在 stage 和步骤标签中, 根据动作的对象和流程差异使用合适的变量生成更细致的显示名称.</p>
<h2 id="注释格式">注释格式</h2>
<p>流水线注释是不限制中英文使用和长度的, 但应当尽量保持逻辑条理清晰简洁, 注释主要目的在于提高代码的可读性, 因此注释要让其他团队成员可以理解你的代码意图, 另外,清晰条理的代码本身可以省去很多不必要的注解.</p>
<h4 id="单行注释">单行注释</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#75715e">// this is a single line comment
</span><span style="color:#75715e"></span>do_something  <span style="color:#75715e">// 单行注释示例
</span></code></pre></div><p>当注释长度小于半行长度, 可以用单行注释插入到代码的行尾或者单独一行.</p>
<p>当注释长度大于3行请考虑使用多行注释.</p>
<h4 id="多行注释">多行注释</h4>
<p>针对一整段函数逻辑, 或者一个复杂脚本的调用接口, 我们通常需要完整的一段文本进行关键信息的标注和解释, 这时应采用多行注释.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#75715e">/* a standalone multiline comment
</span><span style="color:#75715e">comment
</span><span style="color:#75715e">comment
</span><span style="color:#75715e">comment
</span><span style="color:#75715e">end of comment or statment */</span>
do_something
</code></pre></div><h4 id="文档注释">文档注释</h4>
<p>使用 groovy 编写自定义流水线模块时, groovy 同其他语言一样也支持代码的文档注释, 为了保持其可读性, 模块文档应当至少包含对自身基本逻辑, 数据处理流程, 关键函数结构, 关键变量等内容的注解, 并且尽量遵照 groovy 语法规范.</p>
<p>文档注释也是一种多行注释, 并且允许使用与java文档同样的标签.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#75715e">/**
</span><span style="color:#75715e"> * A Class description
</span><span style="color:#75715e"> */</span>
<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span> <span style="color:#f92672">{</span>
  <span style="color:#75715e">/** the name of the person */</span>
  String name 

  <span style="color:#75715e">/**
</span><span style="color:#75715e">   * Creates a greeting method for a certain person.
</span><span style="color:#75715e">   * @param otherPerson the person to greet
</span><span style="color:#75715e">   * @return a greeting message
</span><span style="color:#75715e">   */</span>
  String <span style="color:#a6e22e">greet</span><span style="color:#f92672">(</span>String otherPerson<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;Hello ${otherPerson}&#34;</span>
  <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span> 
</code></pre></div><p>使用中应当根据代码内容复杂度添加合适注解内容, 如,注释特殊或者变量时应当尽量给出内容示例, 注释函数时应标注函数的用途, 输入参数, 参数类型, 输出类型等.</p>
<h2 id="credentials与密码配置">credentials与密码配置</h2>
<p>在流水线中应当尽量减少明文明文密码的使用, 关键登录信息建议使用 <code>Credentials Plugin</code> 插件,</p>
<p>可以登录 <code>http://&lt;服务器地址&gt;/credentials/store/system/domain/_/newCredentials</code> , 或者</p>
<p>从菜单进入, Jenkins -&gt; Credentials -&gt; Stores scoped to Jenkins 在下拉菜单中选择添加, 填充以下信息</p>
<pre><code>Kind: Username with password
Scope: Global
Username: root
Password: !QAZ2wsx
ID: default_user_for_test
Description: default password for test
</code></pre><p>凭据在 pipline 的引用示例</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy">    steps<span style="color:#f92672">{</span>
        withCredentials<span style="color:#f92672">(</span><span style="color:#f92672">[</span>usernamePassword<span style="color:#f92672">(</span>credentialsId: <span style="color:#e6db74">&#39;default_user_for_test&#39;</span><span style="color:#f92672">,</span> passwordVariable: <span style="color:#e6db74">&#39;password&#39;</span><span style="color:#f92672">,</span> usernameVariable: <span style="color:#e6db74">&#39;username&#39;</span><span style="color:#f92672">)</span><span style="color:#f92672">]</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        sh <span style="color:#e6db74">&#39;sshpass -p $password ssh $username@192.168.1.1 &#34;lsblk&#34;&#39;</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
</code></pre></div><p>这样可以更好的保护关键登录信息的安全性, 也保证了代码的规范性.</p>
<h2 id="执行环境依赖">执行环境依赖</h2>
<p>流水线任务中通常都会带有任务自身的环境依赖条件, 这些依赖也应当作为流水线的一部分被记录和维护, 从而保证流水线的正常运行.</p>
<h4 id="容器依赖">容器依赖</h4>
<p>如果流水线执行所依赖的容器环境为公用软件源上拉取的镜像需要指明所依赖的镜像和具体的版本号, 如 <code>centos:centos7</code> , 最好不要忽略镜像所使用的标签, 因为不标注标签的情况下等同于使用 <code>latest</code> , 而 <code>latest</code> 标签所指向的镜像可能会发生更新和变动.  若依赖的进行为私有镜像, 建议将私有镜像的原始构建文件包含在流水线项目中.</p>
<h4 id="节点软件包依赖">节点软件包依赖</h4>
<p>针对构建节点的软件包依赖, 需要根据依赖的类型, 来源和对应的安装方式在流水线项目中给出可复刻的环境配置脚本或者说明文档, 并且软件包的来源如果存在可能失效的情况则必须针对依赖的软件包进行离线源备份并记录使用文档.</p>
<h2 id="输出配置">输出配置</h2>
<p>一份流水线的输出包含了执行过程的日志信息输出和最终的制品输出等, 是一个流水线的执行状态和结果检查的依据, Jenkins 自身对于输出内容的管理能力相对有限, 因此不可避免的需要流水线编写的过程中对输出内容编写单独的处理逻辑.</p>
<h4 id="制品输出">制品输出</h4>
<p>独立的制品管理服务通常会有更好的仓库维护(如,docker仓库), 文件分类, 角色权限控制, 更好的备份恢复, 更好的访问界面与接口, 如支持REST API等.</p>
<p>如果流水线的制品输出较少, 对存储空间要求较低的情况下, 可以将制品输出统一交给 Jenkins 服务器进行处理, 例如, 在流水线中使用 <code>archiveArtifacts </code> 关键字声明制品文件, 然后直接从流水线页面获取制品链接即可.</p>
<p>如果制品较多的情况, 则通常都需要为流水线对接专门的制品管理服务, 不论使用哪一种制品管理软件或者服务, 都应当在流水线项目中给出详细的制品管理规范和使用文档, 如存放的位置, 制品命名规范, 推送更新方式, 获取方式, 用户权限要求等等, 以保证在后续的维护和流水线制品管理中保持制品处理方式的始终统一.</p>
<h4 id="日志输出">日志输出</h4>
<p>对于日志和关键信息输出, 请尽量带有可识别的日志级别标示, 非关键内容则允许过滤处理或者重定向到其他临时输出.</p>
<p>日志级别参考:</p>
<ol>
<li>DEBUG  指出细粒度信息事件对调试应用程序是非常有帮助的, 主要用于开发过程中打印一些运行信息.</li>
<li>INFO  消息在粗粒度级别上突出强调应用程序的运行过程. 打印一些你感兴趣的或者重要的信息, 这个可以用于生产环境中输出程序运行的一些重要信息, 但是不能滥用, 避免打印过多的日志.</li>
<li>WARN  表明会出现潜在错误的情形, 有些信息不是错误信息, 但是也要给程序员的一些提示.</li>
<li>ERROR  指出虽然发生错误事件, 但仍然不影响系统的继续运行. 打印错误和异常信息, 如果不想输出太多的日志, 可以使用这个级别.</li>
<li>FATAL  指出每个严重的错误事件将会导致应用程序的退出. 这个级别比较高了. 重大错误, 这种级别你可以直接停止程序了.</li>
</ol>
<h2 id="groovy代码块">groovy代码块</h2>
<p>groovy 可以省略行尾的分号, 省略它们可以让代码更加简洁.</p>
<p>代码缩进没有硬性要求但是建议使用 4个空格, 避免使用 <code>tab</code> 以免在部分编辑器和终端中存在缩进显示混乱的状况.</p>
<p>当流水线中的某一函数行数超过 50 行请考虑将该函数拆分成独立模块的一部分, 以保持流水线的简洁性.</p>
<h4 id="值和对象的比较">值和对象的比较</h4>
<p>groovy 中如果需要进行值的比较, 可以使用双等于 <code>==</code> 判别符号, 它等同于 equals() 方法.</p>
<p>如果需要比较对象引用, 请使用 <code>is()</code> 方法, 而不是 <code>==</code></p>
<h4 id="模块-shebang">模块 shebang</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#75715e">#!/usr/bin/env groovy</span>
println <span style="color:#e6db74">&#34;hello shebang&#34;</span>
</code></pre></div><p>类Unix环境下使用时, 建议为 groovy 模块应添加自身的 shebang 信息, 以调试运行和后续维护.</p>
<h4 id="模块拆分">模块拆分</h4>
<p>当流水线中存在多处(3次以上甚至更多)的重复性组合动作出现的情况(例如,批量的刷新数据与配置文件解析等), 编码人员就应当考虑为代码添加可共用函数来解决代码冗余的问题, 多个关联的函数代码块可以存放在一个公共的模块中, 以方便调用和代码管理.</p>
<h4 id="模块函数">模块函数</h4>
<p>在进行模块函数编写时应当尽量采用纯函数进行编写, 保证函数尽量在任务无关的独立逻辑中运行, 可以存在其他依赖但是不应当出现与具体某一任务绑定的情况. groovy 函数也推荐采用小驼峰命名法, 如, getTaskNum()</p>
<p>模块函数应当尽量使用 <code>return</code> 显示定义自身的返回值, 或者在最后一个表达式前增加换行以提高可读性.</p>
<h4 id="脚本拆分">脚本拆分</h4>
<p>当流水线中需要较长(比如20行以上)的其他脚本代码块(比如shell/python)才能完成动作时, 建议采用独立的脚本执行任务动作, 而在流水线中保留关键的调用参数的方式来处理.</p>
<p>注意, 拆分出来的脚本尽量使用显示的参数传递方式, 而不要采用不可见的自定义环境变量传递数据.</p>
<h4 id="命令字符串拼接与转译">命令字符串拼接与转译</h4>
<p>除了通用的单引号好双引号写法, 以下几种字符串的写法也 groovy 允许的:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#75715e">// 单行
</span><span style="color:#75715e"></span><span style="color:#66d9ef">def</span> foo <span style="color:#f92672">=</span> <span style="color:#e6db74">$/.*foo.*/$</span>
<span style="color:#66d9ef">def</span> foo <span style="color:#f92672">=</span> <span style="color:#e6db74">/.*foo.*/</span>

<span style="color:#75715e">// 特殊转译
</span><span style="color:#75715e"></span><span style="color:#66d9ef">def</span> escapeSlash <span style="color:#f92672">=</span> <span style="color:#e6db74">/The character \/</span> is a forward slash<span style="color:#e6db74">/
</span><span style="color:#e6db74">def escapeDollar = $/</span>The character <span style="color:#960050;background-color:#1e0010">\</span>$ is a escaped dollar sign<span style="color:#e6db74">/$
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">/</span><span style="color:#e6db74">/ 多行字符
</span><span style="color:#e6db74">def multilineSlashy = /</span>one
    two
    three
<span style="color:#e6db74">/
</span><span style="color:#e6db74">def multilineSingleQuote = $/</span>
    foo
    bar
<span style="color:#f92672">/</span>$
</code></pre></div><p>不过一般情况下我们并不建议过多使用美元符加斜线 <code>$/.../$</code> 格式和 斜线 <code>/.../</code> 格式, 相较而言, 使用引号的情况转义字符会更加符合常规的阅读习惯.</p>
<h4 id="shell-字符串">shell 字符串</h4>
<p>当流水线中存在有较多对诸如 bash 等长命令的字符串进行拼接处理任务时, 应当尽量使用单独的模块进行字符串拼接.</p>
<p>一般地, 在流水线中引入额外的 shell 中间变量和管道时会让出错的 debug 变得困难, 因为需要来回在流水线和 shell 的上下文环境来回进行推演才能定位问题, 我们建议尽量先将字符串拼接任务在流水线内使用 groovy 代码处理完再交给shell处理, 如果是相对复杂的情况也可以考虑将这部分长命令内容拆分成独立的脚本或者模块, 这样可以相对提高流水线代码的简洁程度和可读性.</p>
<p>因为转译符号越多看起来也就越杂乱不容易维护. 当流水线中的命令文本存在较多的字符需要转译的情况也应当遵循, 先拼接再执行的原则进行处理, 或者最好直接拆分到独立的脚本里.</p>
<h4 id="参数传递">参数传递</h4>
<p>独立拆分的脚本应当尽量保持独立的参数解析和运行输出能力, 以方便模块测试, 流水线向脚本传递参数时应当采用显示参数传递, 尽量避免没有声明和注释说明的环境变量传递.</p>
<h4 id="def-和具体类型">Def 和具体类型</h4>
<p>避免把 <code>def</code> 和具体类型一起使用. 要么使用 <code>def</code>,要么使用一个具体类型.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#75715e">// 不要这样写：
</span><span style="color:#75715e"></span><span style="color:#66d9ef">def</span> String name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;someText&#34;</span>

<span style="color:#75715e">// 较好的是这样：
</span><span style="color:#75715e"></span>String name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;someText&#34;</span>
</code></pre></div><p>在Groovy中，def 表明的实际类型是 Object (这样你就可以给 def 定义的变量分配任何对象, 和在用 def 定义的方法里返回任何类型的对象).</p>
<h4 id="引用格式">引用格式</h4>
<p>普通变量的引用, groovy 支持多种引用标识符, 例如, 一个 map 类型的引用格式:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy">map<span style="color:#f92672">.</span><span style="color:#a6e22e">keyName</span>
map<span style="color:#f92672">[</span><span style="color:#e6db74">&#39;keyName&#39;</span><span style="color:#f92672">]</span>

<span style="color:#75715e">// 其他引用标识符
</span><span style="color:#75715e"></span>map<span style="color:#f92672">.</span><span style="color:#e6db74">&#39;single quote&#39;</span>
map<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;double quote&#34;</span>
map<span style="color:#f92672">.</span><span style="color:#e6db74">&#39;&#39;&#39;triple single quote&#39;&#39;&#39;</span>
map<span style="color:#f92672">.</span><span style="color:#e6db74">&#34;&#34;&#34;triple double quote&#34;&#34;&#34;</span>
map<span style="color:#f92672">.</span><span style="color:#e6db74">/slashy string/</span>
map<span style="color:#f92672">.</span><span style="color:#e6db74">$/dollar slashy string/$</span>
</code></pre></div><p>过多的引用格式混用将会很大程度增加代码的阅读负担, 建议统一使用一种引用形式写法, 例如采用 <code>env.&lt;变量名&gt;</code> 或 <code>env['变量名']</code> 的方式, 但同一份流水线尽量避免使用多种引用格式.</p>
<p>groovy 支持字符串中使用 <code>${}</code> 占位符来与 <code>$</code> 前缀来引用变量和使用表达式, 如, <code>$person.name</code> , 我们相对建议脚本中统一使用一种即可.</p>
<h4 id="圆括号省略">圆括号省略</h4>
<p>Groovy 允许你省略顶级层次表达式的圆括号，如用 <code>println</code> 的命令</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#75715e">// 省略圆括号
</span><span style="color:#75715e"></span>println <span style="color:#e6db74">&#34;Hello&#34;</span> 
method a<span style="color:#f92672">,</span> b

<span style="color:#75715e">// VS：
</span><span style="color:#75715e"></span>println<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Hello&#34;</span><span style="color:#f92672">)</span> 
method<span style="color:#f92672">(</span>a<span style="color:#f92672">,</span> b<span style="color:#f92672">)</span>
</code></pre></div><p>这里, 我们不做硬性限制, 但是相对建议代码块保留圆括号.</p>
<p>同样, 在进行闭包调用的过程中也可有允许省略圆括号的写法, 例如, 闭包作为一个方法调用的最后一个参数时</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#75715e">// 完整
</span><span style="color:#75715e"></span>list<span style="color:#f92672">.</span><span style="color:#a6e22e">each</span><span style="color:#f92672">(</span> <span style="color:#f92672">{</span> println it <span style="color:#f92672">}</span> <span style="color:#f92672">)</span> 
<span style="color:#75715e">// 将闭包写在外面
</span><span style="color:#75715e"></span>list<span style="color:#f92672">.</span><span style="color:#a6e22e">each</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">{</span> println it <span style="color:#f92672">}</span> 
<span style="color:#75715e">// 省略前面方法的圆括号
</span><span style="color:#75715e"></span>list<span style="color:#f92672">.</span><span style="color:#a6e22e">each</span> <span style="color:#f92672">{</span> println it <span style="color:#f92672">}</span>
</code></pre></div><p>这里我们三种写法都允许, 但是相对建议第一和最后一种, 并且要注意持整体写法的统一.</p>
<h4 id="直接访问字段属性">直接访问字段属性</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy">resourcePrototype<span style="color:#f92672">.</span><span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;something&#34;</span>
<span style="color:#75715e">// 等价于
</span><span style="color:#75715e"></span>resourcePrototype<span style="color:#f92672">.</span><span style="color:#a6e22e">setName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;something&#34;</span><span style="color:#f92672">)</span>
</code></pre></div><p>在 Groovy 中, 一个 getter 和 setter 方法形成了我们所谓的&quot;属性&rdquo;, 并提供了一个捷径来访问和设置这些属性, 你可以使用一个类似字段访问的方式.</p>
<h4 id="使用-with-简化bean操作">使用 with 简化bean操作</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy">server<span style="color:#f92672">.</span><span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> application<span style="color:#f92672">.</span><span style="color:#a6e22e">name</span> 
server<span style="color:#f92672">.</span><span style="color:#a6e22e">status</span> <span style="color:#f92672">=</span> status 
server<span style="color:#f92672">.</span><span style="color:#a6e22e">sessionCount</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span> 
server<span style="color:#f92672">.</span><span style="color:#a6e22e">start</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> 
server<span style="color:#f92672">.</span><span style="color:#a6e22e">stop</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span>

<span style="color:#75715e">// VS：
</span><span style="color:#75715e"></span>
server<span style="color:#f92672">.</span><span style="color:#a6e22e">with</span> <span style="color:#f92672">{</span> 
    name <span style="color:#f92672">=</span> application<span style="color:#f92672">.</span><span style="color:#a6e22e">name</span>
    status <span style="color:#f92672">=</span> status 
    sessionCount <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span> 
    start<span style="color:#f92672">(</span><span style="color:#f92672">)</span> 
    stop<span style="color:#f92672">(</span><span style="color:#f92672">)</span> 
<span style="color:#f92672">}</span>
</code></pre></div><p>两种写法中, 我们推荐使用 with 语句简化重复的前缀.</p>
<h4 id="安全导航操作符">安全导航操作符</h4>
<p>在 groovy 中如果需要逐层引用安全检查的情况, 建议使用 <code>?.</code> 安全引用操作符进行代码简化, 如</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#75715e">// 手动检查
</span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>order <span style="color:#f92672">!</span><span style="color:#f92672">=</span><span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>order<span style="color:#f92672">.</span><span style="color:#a6e22e">getCustomer</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">!</span><span style="color:#f92672">=</span><span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>order<span style="color:#f92672">.</span><span style="color:#a6e22e">getCustomer</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getAddress</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">!</span><span style="color:#f92672">=</span><span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span> 
            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>order<span style="color:#f92672">.</span><span style="color:#a6e22e">getCustomer</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getAddress</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span> 
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
<span style="color:#75715e">// 安全引用操作符
</span><span style="color:#75715e"></span>println order<span style="color:#f92672">?</span><span style="color:#f92672">.</span><span style="color:#a6e22e">customer</span><span style="color:#f92672">?</span><span style="color:#f92672">.</span><span style="color:#a6e22e">address</span>
</code></pre></div><p>安全引用操作符的调用链中会自动进行空值检查, 任何元素为 <code>null</code> 都不会抛出 <code>NullPointerException</code> 异常, 如果有一个为<code> null</code> 则返回值也是 <code>null</code>.</p>
<h4 id="内插字符串">内插字符串</h4>
<p>在进行字符串处理的过程中, 通常有下面的写法</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy">result_str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Unable to convert resource: &#34;</span> <span style="color:#f92672">+</span> resource

<span style="color:#75715e">// GString:
</span><span style="color:#75715e"></span>result_str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Unable to convert resource: ${resource}&#34;</span>
result_str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Unable to convert resource: $resource&#34;</span>
<span style="color:#75715e">// 闭包表达式
</span><span style="color:#75715e"></span>result_str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Unable to convert resource: ${-&gt; resource}&#34;</span>
</code></pre></div><p>这里的几种写法都是可以的, 但是相对推荐使用内插字符串进行字符串和变量的串联处理, 相对可以降低书写负担.</p>
<p>注意, groovy 里不同的引号的使用作用效果是很不一样的, 处理单行字符, groovy 中单引号总是创建 java 字符串, 没有内插变量, 双引号则既可以创建字符串, 也可以有内插变量 (有点类似于 shell).</p>
<p>不过对于多行字符串处理, 你还可以使用三个引号, 不同引号效果依然不同, 单纯的字符串使用三个单引号, GString 使用三个双引号.</p>
<h4 id="集合工具">集合工具</h4>
<p>在 groovy 语言中,, 常见的 java 循环写法也是可以正常运行的, 但是我们应当尽量使用, groovy 本身提供的遍历工具来进行编写, 如</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#75715e">// 经典for循环
</span><span style="color:#75715e"></span><span style="color:#66d9ef">for</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#f92672">;</span>i<span style="color:#f92672">&lt;</span>list<span style="color:#f92672">.</span><span style="color:#a6e22e">size</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>i<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">{</span>
        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>list<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span>i<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

<span style="color:#75715e">// 使用 each
</span><span style="color:#75715e"></span>list<span style="color:#f92672">.</span><span style="color:#a6e22e">each</span><span style="color:#f92672">{</span>
    println it
<span style="color:#f92672">}</span>
</code></pre></div><p>集合处理 groovy 风格代码 (这里也省略圆括号的闭包写法).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#75715e">// 使用 each
</span><span style="color:#75715e"></span><span style="color:#66d9ef">def</span> result <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#f92672">]</span>
list<span style="color:#f92672">.</span><span style="color:#a6e22e">each</span><span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>it<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">2</span><span style="color:#f92672">)</span>
    result <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> it
<span style="color:#f92672">}</span>
println result
<span style="color:#75715e">// 使用 groovy 集合方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">def</span> result <span style="color:#f92672">=</span> list<span style="color:#f92672">.</span><span style="color:#a6e22e">grep</span><span style="color:#f92672">{</span> it <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">}</span>

<span style="color:#75715e">// 使用 each
</span><span style="color:#75715e"></span><span style="color:#66d9ef">def</span> result <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#f92672">]</span>
list<span style="color:#f92672">.</span><span style="color:#a6e22e">each</span><span style="color:#f92672">{</span>
    result <span style="color:#f92672">&lt;</span><span style="color:#f92672">&lt;</span> it<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span>
<span style="color:#f92672">}</span>
<span style="color:#75715e">// 集合方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">def</span> result <span style="color:#f92672">=</span> list<span style="color:#f92672">.</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">{</span> it<span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">}</span>
</code></pre></div><p>类似的还有  <code>find(Closure closure)</code>, <code>findALL(Closure closure)</code> 等.</p>
<p>元素判断操作</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-groovy" data-lang="groovy"><span style="color:#66d9ef">boolean</span> isMoreThanZero <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
<span style="color:#66d9ef">for</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#66d9ef">in</span> list<span style="color:#f92672">)</span>
<span style="color:#f92672">{</span>
    <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>i<span style="color:#f92672">&lt;</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#f92672">)</span>
    <span style="color:#f92672">{</span>
        isMoreThanZero <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>
        <span style="color:#66d9ef">break</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
println isMoreThanZero

<span style="color:#75715e">// every 方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">def</span> isMoreThanZero <span style="color:#f92672">=</span> list<span style="color:#f92672">.</span><span style="color:#a6e22e">every</span><span style="color:#f92672">{</span> it<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span> <span style="color:#f92672">}</span>
</code></pre></div><p>类似的还有 <code>any(Closure closure)</code>, <code>any()</code>, <code>every()</code>, <code>count()</code>, <code>join()</code> 等.</p>
<h4 id="类型建议">类型建议</h4>
<p>groovy 中是否使用显示的强类型是由用户自己决定的, 这里我们给出一个简单建议, 如果你的代码是不需要作为外部调用的API使用的情况下, 可以自由决定, 但是当代码用作公共API的情况下, 应当尽量使用强类型, 这样有利于增强规约, 避免错误的类型传递, 便于维护, 对于 IDE 也更加友好.</p>
<p>附, groovy 语言关键字</p>
<table>
<thead>
<tr>
<th>-</th>
<th>-</th>
<th>-</th>
<th>-</th>
</tr>
</thead>
<tbody>
<tr>
<td>as</td>
<td>assert</td>
<td>break</td>
<td>case</td>
</tr>
<tr>
<td>catch</td>
<td>class</td>
<td>const</td>
<td>continue</td>
</tr>
<tr>
<td>def</td>
<td>default</td>
<td>do</td>
<td>else</td>
</tr>
<tr>
<td>enum</td>
<td>extends</td>
<td>false</td>
<td>finally</td>
</tr>
<tr>
<td>for</td>
<td>goto</td>
<td>if</td>
<td>implements</td>
</tr>
<tr>
<td>import</td>
<td>in</td>
<td>instanceof</td>
<td>interface</td>
</tr>
<tr>
<td>new</td>
<td>null</td>
<td>package</td>
<td>return</td>
</tr>
<tr>
<td>super</td>
<td>switch</td>
<td>this</td>
<td>throw</td>
</tr>
<tr>
<td>throws</td>
<td>trait</td>
<td>true</td>
<td>try</td>
</tr>
<tr>
<td>while</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>特殊字符转义：</p>
<table>
<thead>
<tr>
<th>Escape sequence</th>
<th>Character</th>
</tr>
</thead>
<tbody>
<tr>
<td>\t</td>
<td>tabulation（制表符）</td>
</tr>
<tr>
<td>\b</td>
<td>backspace（回退符）</td>
</tr>
<tr>
<td>\n</td>
<td>newline（换行符）</td>
</tr>
<tr>
<td>\r</td>
<td>carriage return（回车符）</td>
</tr>
<tr>
<td>\f</td>
<td>formfeed（换页符）</td>
</tr>
<tr>
<td>\</td>
<td>backslash（反斜杠）</td>
</tr>
<tr>
<td>'</td>
<td>single quote within a single-quoted string (and optional for triple-single-quoted and double-quoted strings)（单引号）</td>
</tr>
<tr>
<td>&quot;</td>
<td>double quote within a double-quoted string (and optional for triple-double-quoted and single-quoted strings)（双引号）</td>
</tr>
</tbody>
</table>
<p>字符串汇总表</p>
<table>
<thead>
<tr>
<th>String name</th>
<th>String syntax</th>
<th>Interpolated</th>
<th>Multiline</th>
<th>Escape character</th>
</tr>
</thead>
<tbody>
<tr>
<td>Single-quoted</td>
<td><code>'…'</code></td>
<td></td>
<td></td>
<td><code>\</code>              |</td>
</tr>
<tr>
<td>Triple-single-quoted</td>
<td><code>'''…'''</code></td>
<td></td>
<td><em>√</em></td>
<td><code>\</code>              |</td>
</tr>
<tr>
<td>Double-quoted</td>
<td><code>&quot;…&quot;</code></td>
<td><em>√</em></td>
<td></td>
<td><code>\</code>              |</td>
</tr>
<tr>
<td>Triple-double-quoted</td>
<td><code>&quot;&quot;&quot;…&quot;&quot;&quot;</code></td>
<td><em>√</em></td>
<td><em>√</em></td>
<td><code>\</code>              |</td>
</tr>
<tr>
<td>Slashy</td>
<td><code>/…/</code></td>
<td><em>√</em></td>
<td><em>√</em></td>
<td><code>\</code>              |</td>
</tr>
<tr>
<td>Dollar slashy</td>
<td><code>$/…/$</code></td>
<td><em>√</em></td>
<td><em>√</em></td>
<td><code>$</code></td>
</tr>
</tbody>
</table>
<p>官方 <a href="http://www.groovy-lang.org/syntax.html">groovy 语法文档</a></p>
<p>官方 <a href="http://www.groovy-lang.org/style-guide.html">代码风格指南</a></p>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">willmei</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2020-08-14
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://www.iterdaily.com/tags/jenkins/">jenkins</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/markdown-preview/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">MarkDown 快速上手</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/web_django_upgrade_sqlite3/">
            <span class="next-text nav-default">如何正确升级 sqlite3 (CentOS)</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="mailto:williammei@126.com" rel="me noopener" class="iconfont"
      title="email" >
      <svg class="icon" viewBox="0 0 1451 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M664.781909 681.472759 0 97.881301C0 3.997201 71.046997 0 71.046997 0L474.477909 0 961.649408 0 1361.641813 0C1361.641813 0 1432.688811 3.997201 1432.688811 97.881301L771.345323 681.472759C771.345323 681.472759 764.482731 685.154773 753.594283 688.65053L753.594283 688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858L682.561621 688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759L664.781909 681.472759ZM718.063616 811.603883C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633 0 212.052267 0 212.052267L0 942.809523C0 942.809523 0 1024 83.726336 1024L682.532949 1024 753.579947 1024 1348.948139 1024C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523L1432.688811 212.052267C1432.688811 212.052267 893.138176 701.759633 817.019477 767.734955 777.248 802.205449 742.347691 811.03081 718.063616 811.603883L718.063616 811.603883Z"></path>
</svg>

    </a>
  
    <a href="https://github.com/will-mei" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>
  
    <a href="https://git.iterdaily.com" rel="me noopener" class="iconfont"
      title="gitlab"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M59.544137 403.419429L512.115566 983.405714 16.09728 623.396571a39.936 39.936 0 0 1-14.299429-43.995428l57.709715-176.018286z m264.009143 0h377.161143L512.152137 983.405714zM210.40128 53.723429l113.152 349.696H59.544137l113.152-349.696a20.041143 20.041143 0 0 1 37.705143 0z m754.285714 349.696l57.709715 176.018285a39.862857 39.862857 0 0 1-14.299429 43.995429l-496.018286 360.009143 452.571429-579.986286z m0 0h-264.009143l113.152-349.696a20.041143 20.041143 0 0 1 37.705143 0z"></path>
</svg>

    </a>
  
    <a href="https://space.bilibili.com/7388823" rel="me noopener" class="iconfont"
      title="bilibili"  target="_blank"
      >
      <svg
  class="icon" style="" viewBox="0 0 1024 1024" version="1.1" width="36"
  height="36" id="svg8">
  <path
      style=""
      d="M 744.60599,0.00486267 A 41.779915,41.779915 0 0 0 710.4184,18.673394 L 548.5048,255.32642 h -11.70046 a 41.779915,41.779915 0 0 0 -10.80295,-7.84928 L 235.66,97.084498 a 41.779915,41.779915 0 0 0 -20.07193,-4.960864 41.779915,41.779915 0 0 0 -18.3748,79.145436 L 359.4859,255.32642 H 128.16909 c -49.458302,0 -89.27932,39.82105 -89.27932,89.27932 v 508.65224 c 0,49.4583 39.821018,89.27934 89.27932,89.27934 h 19.48445 C 149.12802,984.5043 179.92773,1024 224.79179,1024 c 44.86407,0 75.66379,-39.4957 77.13826,-81.46268 H 719.98116 C 721.45559,984.5043 752.25533,1024 797.1194,1024 c 44.86406,0 75.6638,-39.4957 77.13824,-81.46268 h 21.57323 c 49.45831,0 89.27936,-39.82104 89.27936,-89.27934 V 344.60574 c 0,-49.45827 -39.82105,-89.27932 -89.27936,-89.27932 H 649.74567 L 779.38103,65.866924 A 41.779915,41.779915 0 0 0 744.60599,0.00486267 Z M 644.49108,418.70871 c 6.29985,0.21538 12.44451,2.01107 17.86888,5.22196 l 171.36218,98.10771 c 18.23417,10.21935 24.63334,33.34627 14.24614,51.48533 -10.38726,18.13909 -33.57344,24.32718 -51.61587,13.77296 L 624.9903,489.18895 c -15.21356,-8.41858 -22.66871,-26.1765 -18.03211,-42.93436 4.63664,-16.75784 20.15573,-28.14465 37.53289,-27.54588 z M 350.2006,432.31846 c 16.89952,0.0317 31.69582,11.33328 36.17844,27.62747 4.48262,16.2942 -2.44981,33.57765 -16.95507,42.24898 l -140.7157,86.91312 c -17.68528,11.18244 -41.09629,5.77692 -52.08912,-12.02686 -10.99282,-17.80373 -5.33855,-41.15658 12.58167,-51.95857 L 329.9002,438.2095 c 6.0643,-3.86439 13.10951,-5.90891 20.3004,-5.89104 z M 501.605,641.53985 c 3.75002,-0.15248 7.48645,0.53903 10.93349,2.0235 0.15842,0.0637 0.31618,0.12888 0.47325,0.19582 0.59328,0.27092 1.17574,0.56489 1.74609,0.88121 0.15868,0.0854 0.31643,0.17233 0.47325,0.2611 0.55694,0.32165 1.10131,0.66458 1.63185,1.02807 0.16455,0.1123 0.32777,0.2265 0.48956,0.34269 0.50382,0.36781 0.99371,0.75428 1.46868,1.15864 0.18724,0.15504 0.37218,0.31282 0.55484,0.47323 0.43271,0.38784 0.8518,0.79061 1.25653,1.20756 0.15449,0.16114 0.30679,0.32437 0.45693,0.48959 0.40798,0.44266 0.79989,0.89988 1.17494,1.37076 0.17799,0.22544 0.35205,0.45395 0.5222,0.68538 0.25932,0.34701 0.50964,0.70071 0.75064,1.06071 0.26712,0.39516 0.52286,0.79784 0.76699,1.20757 0.16907,0.29043 0.33231,0.58424 0.48957,0.88123 0.21836,0.41297 0.42513,0.83199 0.62009,1.25653 0.14836,0.32333 0.28983,0.64976 0.42429,0.97911 0.21319,0.51552 0.40915,1.03801 0.58747,1.5666 0.0677,0.19499 0.13296,0.39085 0.19582,0.58748 0.18652,0.60823 0.34984,1.22334 0.48957,1.84399 0.0397,0.16277 0.0779,0.32601 0.11423,0.48957 0.1436,0.69112 0.25788,1.38801 0.34269,2.08877 0.005,0.0381 0.0111,0.0761 0.0163,0.11424 0.0857,0.78056 0.13474,1.56471 0.14687,2.34988 0.005,0.0543 0.0111,0.10879 0.0163,0.1632 0,0 -0.008,1.12132 0,1.45234 0,0 -0.14697,17.84761 5.89102,34.12231 3.01902,8.13734 7.33278,15.10615 12.61433,19.61501 5.28157,4.50889 11.42894,7.62081 23.64572,7.62081 12.2168,0 18.36416,-3.11192 23.64573,-7.62081 5.28154,-4.50886 9.5953,-11.47767 12.6143,-19.61501 6.03799,-16.2747 5.89103,-34.12231 5.89103,-34.12231 -0.44885,-13.87045 10.45922,-25.46302 24.3311,-25.86506 13.87189,-0.40201 25.42828,10.53953 25.78348,24.41272 0,0 1.11929,25.7226 -9.00791,53.01927 -5.06359,13.64832 -13.1986,28.46036 -27.05631,40.29073 -13.85772,11.83039 -33.5454,19.63135 -56.20142,19.63135 -22.65603,0 -42.34371,-7.80096 -56.20141,-19.63135 -4.1801,-3.56856 -7.78733,-7.42433 -10.99878,-11.42303 -3.21235,4.00037 -6.81703,7.85309 -10.99876,11.42303 -13.85773,11.83039 -33.5454,19.63135 -56.20144,19.63135 -22.65601,0 -42.3437,-7.80096 -56.2014,-19.63135 -13.85775,-11.83037 -21.99272,-26.64241 -27.05632,-40.29073 -10.12725,-27.29667 -9.00789,-53.01928 -9.00789,-53.01927 0.20714,-13.83687 11.58744,-24.88848 25.42444,-24.69013 14.1263,0.19991 25.2971,12.0278 24.69011,26.14247 0,0 -0.14697,17.84761 5.89103,34.12231 3.01902,8.13734 7.31646,15.10615 12.598,19.61501 5.28155,4.50889 11.44526,7.62081 23.66203,7.62081 12.21681,0 18.36418,-3.11192 23.64573,-7.62081 5.28154,-4.50886 9.57899,-11.47767 12.598,-19.61501 5.76352,-15.53489 5.89112,-32.05691 5.89103,-33.56746 0.006,-0.37466 0.0111,-1.05336 0.0163,-1.20759 -0.0117,-0.74583 0.0105,-1.49177 0.0652,-2.23565 0.009,-0.15784 0.0204,-0.31561 0.0327,-0.47324 0.14204,-1.56859 0.43163,-3.12027 0.86487,-4.63449 0.0213,-0.0763 0.0433,-0.15244 0.0652,-0.22848 3.0335,-10.25748 12.24157,-17.46007 22.92769,-17.93417 z"
      id="rect824"/>
</svg>

    </a>


<a href="https://www.iterdaily.com/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
     备案 - <a class="theme-link" href="http://www.beian.miit.gov.cn/">京ICP备19054960号-1</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2019 -
    2021
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        WilliamMei
        
      </span></span>

  
  
    <span id="busuanzi_container">
      访客数/访问量：<span id="busuanzi_value_site_uv"></span>/<span id="busuanzi_value_site_pv"></span>
    </span>
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>












  
    <script type="text/javascript" src="/js/load-photoswipe.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe.min.js"></script>
    <script type="text/javascript" src="/lib/photoswipe/photoswipe-ui-default.min.js"></script>
  




  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>













<script type="text/javascript" src="//cdn.bootcss.com/viz.js/1.3.0/viz.js"> </script>
<script type="text/javascript">
(function(){
    var vizPrefix = "language-viz-";
    Array.prototype.forEach.call(document.querySelectorAll("[class^=" + vizPrefix + "]"), function(x){
        var engine;
        x.getAttribute("class").split(" ").forEach(function(cls){
            if (cls.startsWith(vizPrefix)) {
                engine = cls.substr(vizPrefix.length);
            }
        });
        var image = new DOMParser().parseFromString(Viz(x.innerText, {format:"svg", engine:engine}), "image/svg+xml");
        x.parentNode.insertBefore(image.documentElement, x);
        x.style.display = 'none'
    });
})();
</script>

</body>
</html>
